angular.module("STS",["ui.router"]),angular.module("STS").config(["$urlRouterProvider","$stateProvider","$locationProvider",function(e,t,o){o.html5Mode(!0),e.when("/movies/page/","/movies/page/0"),e.otherwise("/"),t.state("home",{url:"/",templateUrl:"/views/home.html"}).state("movies",{url:"/movies/page/:page",templateUrl:"views/movies.html",controller:"moviesCtrl",resolve:{Movies:["$stateParams","moviesService",function(e,t){return t.getMovies(e.page).then(function(e){return e})}]}}).state("watchedMovies",{url:"/myMovies",templateUrl:"views/watchedMovies.html",controller:"watchedMoviesCtrl",resolve:{watchedMovies:["moviesService",function(e){return e.getWatchedMovies().then(function(e){return e})}]}}).state("search",{url:"/movies/search/:title/page/:page",templateUrl:"views/search.html",controller:"searchCtrl",resolve:{searchResults:["moviesService","$stateParams",function(e,t){return e.searchMovies(t).then(function(e){return e})}]}}).state("movie",{url:"/movie/:id",templateUrl:"views/movieInfo.html",controller:"movieCtrl",resolve:{getMovie:["moviesService","$stateParams",function(e,t){return e.getMovie(t.id).then(function(e){return e})}]}})}]),angular.module("STS").controller("movieCtrl",["$scope","getMovie","moviesService",function(e,t,o){$(".collapsible").collapsible(),e.movie=t.data,e.markAsSeen=function(t){o.markAsSeen(t).then(function(t){200==t.status&&o.getMovie(e.movie.imdb.id).then(function(t){e.movie=t.data})})},e.removeFromWatchedList=function(t){o.removeFromWatchedList(t).then(function(t){200==t.status&&o.getMovie(e.movie.imdb.id).then(function(t){e.movie=t.data})})}}]),angular.module("STS").controller("moviesCtrl",["$scope","Movies","moviesService","$state",function(e,t,o,r){e.movies=t.data.movies,e.pageNum=t.data.pageNum,e.searchQuery={},e.searchMovies=function(e){r.go("search",{title:e.title})},e.markAsSeen=function(t){o.markAsSeen(t).then(function(t){200==t.status&&o.getMovies(e.pageNum).then(function(t){e.movies=t.data.movies})})},e.removeFromWatchedList=function(t){o.removeFromWatchedList(t).then(function(t){200==t.status&&o.getMovies(e.pageNum).then(function(t){e.movies=t.data.movies})})},e.clearQuery=function(){e.searchQuery={},r.transitionTo("movies")}}]),angular.module("STS").controller("searchCtrl",["$scope","searchResults","$state","moviesService",function(e,t,o,r){e.movies=t.data.movies,e.pageNum=t.data.page,e.searchQuery={title:t.data.title},e.searchMovies=function(e){o.go("search",{title:e.title})},e.markAsSeen=function(e){r.markAsSeen(e).then(function(e){o.reload("search")})},e.removeFromWatchedList=function(e){r.removeFromWatchedList(e).then(function(e){o.reload("search")})},e.clearQuery=function(){e.searchQuery={},o.go("movies")}}]),angular.module("STS").controller("watchedMoviesCtrl",["$scope","watchedMovies","moviesService",function(e,t,o){e.movies=t.data,e.removeFromWatchedList=function(t){o.removeFromWatchedList(t).then(function(t){200==t.status&&o.getWatchedMovies().then(function(t){e.movies=t.data})})}}]),angular.module("STS").filter("previousPage",function(){return function(e){return e>0?--e:0}}).filter("nextPage",function(){return function(e){return++e}}),angular.module("STS").service("moviesService",["$http",function(e){var t=this;t.getMovies=function(t){return e.get("/getMovies?page="+t).success(function(e){return e}).error(function(e){console.error("Failed to load movies",e)})},t.markAsSeen=function(t){return e.get("/markAsSeen?id="+t.imdb.id).success(function(e){return e}).error(function(e){console.error("Failed to set movie as Seen",e)})},t.removeFromWatchedList=function(t){return e.get("/removeFromWatchedList?id="+t.imdb.id).success(function(e){return e}).error(function(e){console.error("Failed to remove movie from Seen list",e)})},t.getWatchedMovies=function(){return e.get("/watchedMovies").success(function(e){return e}).error(function(e){console.error("Failed to fetch Watched Movies",e)})},t.searchMovies=function(t){return e.get("/searchMovies?title="+t.title+"&page="+t.page).success(function(e){return 200==e.status?e.data:void 0}).error(function(e){return console.error("Failed to find movies",e),-1})},t.getMovie=function(t){return e.get("/movie?id="+t).success(function(e){return 200==e.status?e:void 0}).error(function(e){return console.error("Failed to find movies",e),-1})}}]);